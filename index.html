<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MITI - Monthly Test System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); min-height: 100vh; color: #fff; }
        .screen { display: none; }
        .screen.active { display: block; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .login-box, .result-box { background: #2d2d2d; padding: 40px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); width: 100%; max-width: 500px; border: 1px solid #444; }
        h1 { color: #fff; text-align: center; margin-bottom: 30px; font-size: 2.5em; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        h2 { color: #fff; margin-bottom: 20px; text-align: center; }
        input, select { width: 100%; padding: 15px; margin: 10px 0; border: 2px solid #444; border-radius: 8px; font-size: 16px; background: #1a1a1a; color: #fff; }
        input:focus, select:focus { outline: none; border-color: #4CAF50; }
        select option { background: #1a1a1a; color: #fff; }
        button { width: 100%; padding: 15px; margin: 10px 0; background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; transition: transform 0.2s; }
        button:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4); }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        .error { color: #ff6b6b; margin-top: 10px; text-align: center; font-weight: bold; }
        .success { color: #4CAF50; margin-top: 10px; text-align: center; font-weight: bold; }
        .info { color: #2196F3; margin-top: 10px; text-align: center; font-size: 14px; }
        .test-header { background: #2d2d2d; padding: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.5); flex-wrap: wrap; gap: 10px; border-bottom: 2px solid #4CAF50; }
        .timer { font-size: 24px; font-weight: bold; color: #ff6b6b; padding: 10px 20px; background: #1a1a1a; border-radius: 8px; border: 2px solid #ff6b6b; }
        .month-badge { background: #4CAF50; color: white; padding: 8px 15px; border-radius: 20px; font-weight: bold; }
        .trade-badge { background: #2196F3; color: white; padding: 8px 15px; border-radius: 20px; font-size: 12px; }
        .test-container { max-width: 900px; margin: 30px auto; background: #2d2d2d; padding: 30px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); border: 1px solid #444; }
        .progress-bar { width: 100%; height: 8px; background: #1a1a1a; border-radius: 10px; margin-bottom: 30px; border: 1px solid #444; }
        .progress { height: 100%; background: linear-gradient(90deg, #4CAF50 0%, #45a049 100%); transition: width 0.3s; border-radius: 10px; }
        .option { padding: 15px; margin: 10px 0; border: 2px solid #444; border-radius: 8px; cursor: pointer; display: flex; align-items: center; transition: all 0.3s; background: #1a1a1a; text-align: left; width: 100%; }
        .option:hover { border-color: #4CAF50; background: #2d2d2d; }
        .option.selected { border-color: #4CAF50; background: #4CAF50; color: white; }
        .option input[type="radio"] { margin-right: 15px; width: 20px; height: 20px; cursor: pointer; flex-shrink: 0; }
        .option-text { flex: 1; }
        .navigation { display: flex; justify-content: space-between; align-items: center; margin-top: 30px; }
        .navigation button { width: auto; padding: 12px 30px; }
        .result-details { margin: 30px 0; padding: 20px; background: #1a1a1a; border-radius: 8px; border: 1px solid #444; }
        .result-details p { margin: 15px 0; font-size: 18px; color: #fff; }
        .result-details span { color: #4CAF50; font-weight: bold; }
        .score-display { font-size: 48px; text-align: center; color: #4CAF50; font-weight: bold; margin: 20px 0; }
        table { width: 100%; background: #2d2d2d; border-collapse: collapse; margin-top: 20px; border-radius: 8px; overflow: hidden; border: 1px solid #444; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #444; color: #fff; }
        th { background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); color: white; font-weight: bold; }
        tr:hover { background: #1a1a1a; }
        .month-select { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        .month-btn { padding: 20px; background: #1a1a1a; border: 2px solid #444; border-radius: 10px; cursor: pointer; text-align: center; font-weight: bold; transition: all 0.3s; color: #fff; position: relative; }
        .month-btn:hover:not(.completed) { border-color: #4CAF50; background: #2d2d2d; }
        .month-btn.selected { border-color: #4CAF50; background: #4CAF50; color: white; }
        .month-btn.completed { border-color: #4CAF50; }
        .month-btn.completed::after { content: '‚úÖ'; position: absolute; top: 10px; right: 10px; font-size: 20px; }
        .footer { position: fixed; bottom: 10px; right: 20px; color: #888; font-size: 14px; font-style: italic; }
        .question h3 { color: #fff; margin-bottom: 20px; text-align: left; }
        .question p { color: #ddd; text-align: left; font-size: 18px; margin-bottom: 20px; }
        #questionCounter { color: #4CAF50; font-weight: bold; }
        .admin-btn { background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%) !important; margin-top: 20px; }
        .time-slot-info { background: #1a1a1a; padding: 15px; border-radius: 8px; margin: 15px 0; border: 2px solid #2196F3; }
        .time-slot-info h4 { color: #2196F3; margin-bottom: 10px; }
        .time-slot-info p { color: #fff; margin: 5px 0; }
        .admin-panel-box { background: #2d2d2d; padding: 30px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); border: 1px solid #444; margin: 20px 0; }
        .btn-group { display: flex; gap: 10px; flex-wrap: wrap; }
        .btn-group button { flex: 1; min-width: 200px; }
        .validation-error { color: #ff6b6b; font-size: 14px; margin-top: 10px; text-align: center; font-weight: bold; }
    </style>
</head>
<body>
    <!-- LOGIN SCREEN -->
    <div id="loginScreen" class="screen active">
        <div class="container">
            <h1>üìö MITI Test System</h1>
            <div class="login-box">
                <h2>Student Login</h2>
                <input type="text" id="studentName" placeholder="Enter Your Name">
                <input type="text" id="studentId" placeholder="Enter Your ID Number">
                
                <select id="tradeSelect">
                    <option value="">-- Select Your Trade --</option>
                    <option value="Computerized Accounting">Computerized Accounting</option>
                    <option value="Data Analytics with AI">Data Analytics with AI</option>
                </select>

                <select id="timingSelect" style="display:none;">
                    <option value="">-- Select Timing --</option>
                </select>
                
                <h3 style="margin-top: 20px; color: #fff; font-size: 16px;">Select Test Month:</h3>
                <div class="month-select" id="monthSelect"></div>
                
                <button onclick="startTest()">Start Test</button>
                <button onclick="showAdminLogin()" class="admin-btn">Admin Panel</button>
                <div id="loginError" class="error"></div>
                <div id="loginInfo" class="info"></div>
            </div>
        </div>
    </div>

    <!-- TEST SCREEN -->
    <div id="testScreen" class="screen">
        <div class="test-header">
            <span class="trade-badge" id="tradeBadge"></span>
            <span class="month-badge" id="monthBadge"></span>
            <div class="timer" id="timer">30:00</div>
        </div>
        <div class="test-container">
            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
            </div>
            <div id="questionContainer" class="question"></div>
            <div id="validationError" class="validation-error"></div>
            <div class="navigation">
                <button onclick="previousQuestion()" id="prevBtn">‚Üê Previous</button>
                <span id="questionCounter"></span>
                <button onclick="nextQuestion()" id="nextBtn">Next ‚Üí</button>
            </div>
        </div>
    </div>

    <!-- RESULT SCREEN -->
    <div id="resultScreen" class="screen">
        <div class="container">
            <div class="result-box">
                <h2>üéâ Test Completed!</h2>
                <div class="score-display" id="scoreDisplay"></div>
                <div class="result-details">
                    <p>Name: <span id="resultName"></span></p>
                    <p>ID: <span id="resultId"></span></p>
                    <p>Trade: <span id="resultTrade"></span></p>
                    <p>Month: <span id="resultMonth"></span></p>
                    <p>Score: <span id="resultScore"></span></p>
                    <p>Percentage: <span id="resultPercentage"></span></p>
                </div>
                <button onclick="location.reload()">Back to Home</button>
            </div>
        </div>
    </div>

    <!-- ADMIN LOGIN -->
    <div id="adminLoginScreen" class="screen">
        <div class="container">
            <h1>üîê Admin Login</h1>
            <div class="login-box">
                <input type="password" id="adminPassword" placeholder="Enter Admin Password">
                <button onclick="adminLogin()">Login</button>
                <button onclick="backToLogin()">Back</button>
                <div id="adminError" class="error"></div>
            </div>
        </div>
    </div>

    <!-- ADMIN PANEL -->
    <div id="adminPanel" class="screen">
        <div class="container" style="max-width: 1200px;">
            <h1>üìä Admin Panel</h1>
            <div class="admin-panel-box">
                <h2>Test Results</h2>
                <div class="btn-group">
                    <button onclick="exportCSV()">üì• Export CSV</button>
                    <button onclick="clearAllData()" style="background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);">üóëÔ∏è Clear All Data</button>
                    <button onclick="backToLogin()">üè† Back to Home</button>
                </div>
                <div id="resultsTable"></div>
            </div>
        </div>
    </div>

    <div class="footer">Developed by Sir Muhammad Faris</div>

    <script>
        // Question Bank
        const questionBank = {
            "Computerized Accounting": {
                1: [
                    {q: "What is MS EXCEL?", options: ["Spread sheets package", "Graphical software", "All of Above", "None of these"], correct: 0},
                    {q: "What does The VLOOKUP function?", options: ["Lookup text that contains 'V'", "Check weather test is the same in one cell as in the text", "Find related values", "All of Above"], correct: 2},
                    {q: "Which function calculates missing loan amount?", options: ["PV (Present Value)", "FV (Future Value)", "PMT (Payment)", "NPER (Number of periods)"], correct: 0},
                    {q: "How many types of cursors in MS excel?", options: ["FIVE", "THREE", "FOUR", "TWO"], correct: 1},
                    {q: "Select the right purpose of 'COUNT'", options: ["Count Alphabets", "Count Numeric", "Count Alpha Numeric", "None of these"], correct: 1},
                    {q: "Which area shows the address of a cell?", options: ["Name Box", "Formula Bar", "Status Bar", "Title Bar"], correct: 0},
                    {q: "Circle the correct short key of edit cell.", options: ["F2", "F3", "F9", "F8"], correct: 0},
                    {q: "To select another particular cell in work sheet", options: ["Ctrl + Click", "Ctrl + shift+ Click", "Ctrl + F7", "Alt + Click"], correct: 0},
                    {q: "What is the meaning of this error #### in a cell?", options: ["Cell width is narrow", "Cell width is long", "None of these", "Formula error"], correct: 0},
                    {q: "What is the File Extension of Excel?", options: [".xlsx", ".Xlx", ".xlsm", ".xls"], correct: 0}
                ],
                2: [
                    {q: "What is the correct syntax of IF()function?", options: ["=IF(logical test, value_if_true, value_if_false)", "=IF (logical test, TRUE([value_if_true]), FALSE([value_if_false]))", "None of these", "All of these"], correct: 0},
                    {q: "Which of the following formula enter is not correctly?", options: ["=B7*C7", "-1- + 50", "10+50", "=10+B7"], correct: 1},
                    {q: "Select the right purpose of count.", options: ["Count specific value in our given rang", "Sum specific value in our given rang", "None of These", "Count all cells"], correct: 0},
                    {q: "How many conditions can we apply in conditional formatting on one range?", options: ["5", "10", "Unlimited", "3"], correct: 2},
                    {q: "What is the purpose of $ sign in formula?", options: ["For currency Symbol", "For Fix Error", "For Fixing cell Address", "All of these"], correct: 2},
                    {q: "Except for the ...... function, a formula with a logical function shows the word \"TRUE\" or \"FALSE\" as a result", options: ["End", "OR", "Not", "IF"], correct: 3},
                    {q: "Which function is used to trap and handle errors?", options: ["IFERROR", "ERROR", "IFNA", "None of these"], correct: 0},
                    {q: "What is shortcut key of sum?", options: ["Alt+ Enter", "Alt + =", "Ctrl + +", "Ctrl + ="], correct: 1},
                    {q: "If we select 5 rows and 5 columns how many cells will be selected", options: ["25", "10", "15", "None of these"], correct: 0},
                    {q: "Which symbol must be with all formulas?", options: ["=", "@", "%", "!"], correct: 0}
                ],
                3: [
                    {q: "Capital + Liabilities = ?", options: ["Revenue", "Assets", "Expense", "Voucher"], correct: 1},
                    {q: "Owner's claim on total assets is?", options: ["Liability", "Assets", "Equity", "Cash"], correct: 2},
                    {q: "Which of the following financial report show the profitable of a business?", options: ["Income Statement", "Balance Sheet", "Cash Flow Statement", "Statement of changes in equity"], correct: 0},
                    {q: "A Cheque returned by bank marked 'NFS' means that?", options: ["Bank can't verify your identity", "There are Not sufficient Balance", "Cheque has been forged", "Cheque can't be cash being illegal"], correct: 1},
                    {q: "Which of the following is fiscal year of Government of Pakistan?", options: ["1st January to 31st December", "1st June to 31st May", "1st July to 30th June", "1st October to 30th September"], correct: 2},
                    {q: "How many companies open at the same time in QuickBooks?", options: ["One", "Two", "Both of above", "None of above"], correct: 0},
                    {q: "Sales Tax charged on?", options: ["Vendor", "Customer", "Employee", "None of above"], correct: 1},
                    {q: "Which person sales Tax Paid?", options: ["Vendor", "Customer", "Employee", "None pf above"], correct: 1},
                    {q: "U/M Stands for?", options: ["Unit Markup", "Unit of Measure", "Unit Management", "Universal Measure"], correct: 1},
                    {q: "How Sale returned transaction recorded in Peachtree?", options: ["Purchase Order‚Üí Enter Bill‚ÜíPay Bill", "Purchase Order‚ÜíEnter Bill", "Sale Order‚Üícreate Invoice‚ÜíCredit & Return‚ÜíReceived payment", "All of Above"], correct: 2}
                ],
                4: [
                    {q: "Circle the correct short key of debug formula and edit cell.", options: ["F2", "F3", "F9", "F8"], correct: 0},
                    {q: "What is the meaning of this error #### in a cell?", options: ["Cell width is narrow", "Cell width is long", "None of these"], correct: 0},
                    {q: "How can we insert a new row in a cell with keyboard?", options: ["Ctrl + Enter", "Ctrl + Alt + Enter", "Alt + Enter"], correct: 2},
                    {q: "Which function in Excel tells how many numeric entries are there?", options: ["NUM", "COUNT", "SUM", "CHKNUM"], correct: 1},
                    {q: "Circle the correct M-Language for insert a file or workbook name in power query.", options: ["Exce.CurrentWorkbook([Content],true)", "Excel.CurrentWorkbook([Content])", "Very Basic Applications", "Visual Basic Applied"], correct: 1},
                    {q: "Why we use Charts and Graphs?", options: ["Graphical Representation", "Numerical Representation", "Immediate window", "Code window"], correct: 0},
                    {q: "Why are purchase order used?", options: ["To post accounting information", "To place an order with a customer", "To request items from vendor"], correct: 2},
                    {q: "Which window do you use to add a new vendor?", options: ["Purchase / Receive Inventory", "Menu Bar", "Maintain vendors"], correct: 2},
                    {q: "Going from the ledger to the original entry window is called?", options: ["Lookup", "Drill down", "None of above"], correct: 1},
                    {q: "Which of the following navigation bar vendor & purchase selection do you use to issue a return of merchandise to a vendor?", options: ["Credit memos", "Sales/invoicing", "Credit & Returns"], correct: 2},
                    {q: "Which of the following choices is not used to modify the chart of accounts?", options: ["Deleting accounts with balances", "Adding new accounts", "Editing accounts", "Deleting unused accounts"], correct: 0},
                    {q: "Which of the following is NOT an Item Type?", options: ["Inventory Part", "Service", "Non-inventory Part", "Income"], correct: 3},
                    {q: "What transaction should you enter if a customer returns a damaged product or, in the case of a service, complains so much you decide to offer a refund?", options: ["Debit Memo", "Credit Memo", "Customer Return", "Check or Bill"], correct: 1},
                    {q: "Which of these functions can only be performed by the Administrator?", options: ["Merge entries on lists", "Add new users and change their access privileges", "Memorize custom reports", "Back up the data file"], correct: 1},
                    {q: "Tally package is developed by", options: ["Saga50", "Tally solution", "Intuit"], correct: 1},
                    {q: "In general, the financial year from shall be from", options: ["1st July of any year", "31st march of any year", "All Answer is correct"], correct: 2},
                    {q: "Which menu appears after starting tally for the first-time", options: ["Gateway of tally", "Company info", "Display"], correct: 0},
                    {q: "Which option is used in tally to make changes in the company", options: ["Select company", "Shut company", "Alter"], correct: 2},
                    {q: "Which option is used to copy company's data into pen-drive or CD", options: ["Backup", "Restore", "Copy data"], correct: 0},
                    {q: "What is VBA?", options: ["Very Basic Applications", "Visual Basic for Applications", "Visual Basic Applied", "None of these"], correct: 1}
                ]
            },
            "Data Analytics with AI": {
                1: [
                    {q: "What is the correct syntax of IF() function?", options: ["=IF(logical test, value_if_true, value_if_false)", "=IF (logical test, TRUE([value_if_true]), FALSE([value_if_false]))", "None of these", "All of these"], correct: 0},
                    {q: "Which of the following formula enter is not correctly?", options: ["=B7*C7", "-1- + 50", "10+50", "=10+B7"], correct: 1},
                    {q: "Pivot table use for?", options: ["Analysis Data", "Find Data", "None of These", "Remove Data"], correct: 0},
                    {q: "How many types of option use in the timeline?", options: ["Years", "Days", "Quater", "All of Above"], correct: 3},
                    {q: "What is the purpose of $ sign in formula?", options: ["For currency Symbol", "For Fix Error", "For Fixing cell Address", "All of these"], correct: 2},
                    {q: "Except for the ...... function, a formula with a logical function shows the word \"TRUE\" or \"FALSE\" as a result", options: ["End", "OR", "Not", "IF"], correct: 3},
                    {q: "Which function is used to trap and handle errors?", options: ["IFERROR", "ERROR", "IFNA", "None of these"], correct: 0},
                    {q: "What is shortcut key of sum?", options: ["Alt+ Enter", "Alt + =", "Ctrl + +", "Ctrl + ="], correct: 1},
                    {q: "If we select 5 rows and 5 columns how many cells will be selected", options: ["25", "10", "15", "None of these"], correct: 0},
                    {q: "Which symbol must be with all formulas?", options: ["=", "@", "%", "#"], correct: 0}
                ],
                2: [
                    {q: "What is a Database in the context described?", options: ["A single table of data", "A collection of related tables", "A programming language", "A type of chart"], correct: 1},
                    {q: "Which SQL command is primarily used to retrieve data from a database?", options: ["INSERT", "UPDATE", "DELETE", "SELECT"], correct: 3},
                    {q: "Which SQL clause is used to filter records based on a specified condition?", options: ["LIMIT", "ORDER BY", "WHERE", "GROUP BY"], correct: 2},
                    {q: "What is a JOIN used for in SQL?", options: ["To combine rows from two or more tables based on a related column", "To insert new rows into a table", "To delete rows from a table", "To modify the structure of a table"], correct: 0},
                    {q: "Which command is used to add new rows of data into a table?", options: ["SELECT", "UPDATE", "INSERT", "ALTER"], correct: 2},
                    {q: "COUNT, SUM, and AVG are examples of what type of functions in SQL?", options: ["Logical Functions", "Lookup Functions", "String Functions", "Aggregate Functions"], correct: 3},
                    {q: "Which SQL clause is used to sort the result set in ascending or descending order?", options: ["WHERE", "LIMIT", "GROUP BY", "ORDER BY"], correct: 3},
                    {q: "What is a Key in the context of databases and tables?", options: ["A clause used in SELECT statements", "A constraint used to establish relationships or ensure data integrity", "A type of SQL command", "An aggregate function"], correct: 1},
                    {q: "Which command is used to modify existing records in a table?", options: ["INSERT", "UPDATE", "DELETE", "ALTER"], correct: 1},
                    {q: "What does the ALTER command in SQL allow you to do?", options: ["Select specific columns from a table", "Modify the structure of an existing table", "Delete all records from a table", "Combine results from multiple SELECT statements"], correct: 1}
                ],
                3: [
                    {q: "In Python, what are int, float, str, and bool examples of?", options: ["Operators", "Variables", "Datatypes", "Functions"], correct: 2},
                    {q: "Which programming construct in Python is used to execute a block of code multiple times?", options: ["Conditional Statement", "Function", "Loop", "Module"], correct: 2},
                    {q: "Lists, Tuples, Dictionaries, and Sets are examples of what in Python?", options: ["Control Flow Structures", "Built-in Functions", "Data Structures", "Operators"], correct: 2},
                    {q: "What is a Lambda Function in Python?", options: ["A function used for looping", "A small, anonymous function", "A function for file handling", "A recursive function"], correct: 1},
                    {q: "Which Python libraries are specifically mentioned for data manipulation and working with arrays?", options: ["Matplotlib and Seaborn", "SQLite and REST APIs", "Pandas and NumPy", "JSON and XML"], correct: 2},
                    {q: "In the context of Python, what are Classes and Objects related to?", options: ["Data Visualization", "File Handling", "Database Operations", "Object-Oriented Programming (OOP) Basics"], correct: 3},
                    {q: "Which module type is mentioned as containing functions and definitions already available in Python?", options: ["Creation of Modules", "Project Random Module", "In-built Modules", "Lambda Functions"], correct: 2},
                    {q: "What operations are listed as part of SQL CRUD Operations in Python?", options: ["Charting and Plotting", "Create, Read, Update, Delete", "Sorting and Filtering", "Merging and Appending"], correct: 1},
                    {q: "Which concept is mentioned as being used with For Loops in Python?", options: ["Recursive Statement", "Conditional Statements", "Lambda Function", "File Handling"], correct: 1},
                    {q: "What is the term for accessing a specific part of a list or tuple in Python?", options: ["Iteration", "Function Calling", "Slicing", "Comprehension"], correct: 2}
                ],
                4: [
                    {q: "To apply formatting to cells based on their values meeting a specific condition, which tool would you use?", options: ["Basic Formatting Tools", "Conditional Formatting Basics", "Data Validation", "Text to Columns"], correct: 1},
                    {q: "Which Excel operation is used to arrange data in ascending or descending order?", options: ["Filtering Data", "Removing Duplicates", "Sorting Data", "Text to Columns"], correct: 2},
                    {q: "Which function is used in Excel to find the smallest value in a range of cells?", options: ["MIN", "AVERAGE", "SUM", "MAX"], correct: 0},
                    {q: "Which Excel tool allows you to summarize and analyze large amounts of data in a table format?", options: ["Pivot Tables", "Basic Charts", "Excel Tables", "Data Validation"], correct: 0},
                    {q: "VLOOKUP and INDEX-MATCH are examples of what type of functions in Excel?", options: ["Basic Math Functions", "Lookup Functions", "Logical Functions", "Aggregate Functions"], correct: 1},
                    {q: "What is a Database in the context described?", options: ["A single table of data", "A collection of related tables", "A programming language", "A type of chart"], correct: 1},
                    {q: "In the context of Python, what are Classes and Objects related to?", options: ["Data Visualization", "File Handling", "Database Operations", "Object-Oriented Programming (OOP) Basics"], correct: 3},
                    {q: "Which SQL clause is used to sort the result set in ascending or descending order?", options: ["WHERE", "LIMIT", "GROUP BY", "ORDER BY"], correct: 3},
                    {q: "What is a Key in the context of databases and tables?", options: ["A clause used in SELECT statements", "A constraint used to establish relationships or ensure data integrity", "A type of SQL command", "An aggregate function"], correct: 1},
                    {q: "What does the ALTER command in SQL allow you to do?", options: ["Select specific columns from a table", "Modify the structure of an existing table", "Delete all records from a table", "Combine results from multiple SELECT statements"], correct: 1},
                    {q: "Which module type is mentioned as containing functions and definitions already available in Python?", options: ["Creation of Modules", "Project Random Module", "In-built Modules", "Lambda Functions"], correct: 2},
                    {q: "Which concept is mentioned as being used with For Loops in Python?", options: ["Recursive Statement", "Conditional Statements", "Lambda Function", "File Handling"], correct: 1},
                    {q: "What does DAX stand for in the context of Power BI?", options: ["Data Analysis Exchange", "Database Access XML", "Data Analysis Expressions", "Digital Analytics Extensions"], correct: 2},
                    {q: "What is the purpose of Calculated Columns and Measures in Power BI, as described?", options: ["To connect to different data sources", "To perform data transformations", "To define calculations on data", "To format visualizations"], correct: 2},
                    {q: "Which action is specifically listed as a basic transformation in Power BI?", options: ["Creating Measures", "Publishing Reports", "Dealing with Unwanted Columns and Null Values", "Designing for Phone Viewers"], correct: 2},
                    {q: "What concept in Power BI relates to defining how tables are connected and filtered?", options: ["Data Visualization", "Data Model and Importance of Data Modeling", "DAX Functions", "Basic Transformations"], correct: 1},
                    {q: "Cardinality and Cross-Filter Direction are concepts related to what in Power BI?", options: ["DAX Syntax", "Managing Data Relationships", "Visualization Charts", "Text Tools"], correct: 1},
                    {q: "Which Power BI feature allows users to filter data interactively on a report page?", options: ["Matrix Visuals", "Slicers", "KPI Visuals", "Tool Tips"], correct: 1},
                    {q: "What type of visual is listed for displaying a single aggregate value clearly?", options: ["TreeMap", "Map Visuals", "Number Cards and Text Cards", "Stacked Bar Chart"], correct: 2},
                    {q: "What is the final step mentioned after creating a report in Power BI?", options: ["Creating DAX Functions", "Publishing Reports to Power BI Services", "Adding Conditional Columns", "Managing Data Relationships"], correct: 1}
                ]
            }
        };

        // Time slots configuration
        const timeSlots = {
            "Computerized Accounting": [
                { label: "Morning (9:00 AM - 12:00 PM)", value: "Morning" },
                { label: "Evening (2:00 PM - 5:00 PM)", value: "Evening" }
            ],
            "Data Analytics with AI": [
                { label: "Morning (9:00 AM - 12:00 PM)", value: "Morning" },
                { label: "Evening (2:00 PM - 5:00 PM)", value: "Evening" }
            ]
        };

        let currentStudent = {};
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let timeLeft = 1800; // 30 minutes
        let timerInterval;

        // Initialize - Trade Select Event Listener
        document.getElementById('tradeSelect').addEventListener('change', function() {
            const trade = this.value;
            const timingSelect = document.getElementById('timingSelect');
            
            if (trade && timeSlots[trade]) {
                timingSelect.style.display = 'block';
                timingSelect.innerHTML = '<option value="">-- Select Timing --</option>';
                timeSlots[trade].forEach(slot => {
                    timingSelect.innerHTML += `<option value="${slot.value}">${slot.label}</option>`;
                });
                updateMonthButtons();
            } else {
                timingSelect.style.display = 'none';
            }
        });

        // Timing Select Event Listener
        document.getElementById('timingSelect').addEventListener('change', function() {
            updateMonthButtons();
        });

        function updateMonthButtons() {
            const trade = document.getElementById('tradeSelect').value;
            const timing = document.getElementById('timingSelect').value;
            const monthSelect = document.getElementById('monthSelect');
            
            if (!trade || !timing) {
                monthSelect.innerHTML = '<p style="color: #ff6b6b; text-align: center;">Please select trade and timing first</p>';
                return;
            }

            const completedTests = getCompletedTests();
            monthSelect.innerHTML = '';
            
            for (let i = 1; i <= 4; i++) {
                const isCompleted = completedTests.some(test => 
                    test.trade === trade && 
                    test.month === i && 
                    test.timing === timing
                );
                
                const btn = document.createElement('div');
                btn.className = 'month-btn' + (isCompleted ? ' completed' : '');
                btn.innerHTML = `Month ${i}${i === 4 ? ' (FINAL)' : ''}`;
                btn.onclick = () => selectMonth(i);
                monthSelect.appendChild(btn);
            }
        }

        function selectMonth(month) {
            document.querySelectorAll('.month-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            currentStudent.month = month;
        }

        function startTest() {
            const name = document.getElementById('studentName').value.trim();
            const id = document.getElementById('studentId').value.trim();
            const trade = document.getElementById('tradeSelect').value;
            const timing = document.getElementById('timingSelect').value;
            const month = currentStudent.month;

            if (!name || !id || !trade || !timing || !month) {
                document.getElementById('loginError').textContent = 'Please fill all fields and select month!';
                return;
            }

            const completedTests = getCompletedTests();
            const alreadyCompleted = completedTests.some(test => 
                test.studentId === id && 
                test.trade === trade && 
                test.month === month &&
                test.timing === timing
            );

            if (alreadyCompleted) {
                document.getElementById('loginError').textContent = 'You have already completed this test!';
                return;
            }

            currentStudent = { name, id, trade, timing, month };
            currentQuestions = questionBank[trade][month];
            
            // Check if questions exist
            if (!currentQuestions || currentQuestions.length === 0) {
                document.getElementById('loginError').textContent = 'No questions available for this test yet!';
                return;
            }

            currentQuestionIndex = 0;
            userAnswers = new Array(currentQuestions.length).fill(null);

            document.getElementById('tradeBadge').textContent = trade;
            document.getElementById('monthBadge').textContent = `Month ${month}${month === 4 ? ' - FINAL TEST' : ''}`;
            
            showScreen('testScreen');
            displayQuestion();
            startTimer();
        }

        function displayQuestion() {
            const q = currentQuestions[currentQuestionIndex];
            const container = document.getElementById('questionContainer');
            
            let html = `
                <h3>Question ${currentQuestionIndex + 1} of ${currentQuestions.length}</h3>
                <p>${q.q}</p>
            `;
            
            q.options.forEach((option, index) => {
                const isSelected = userAnswers[currentQuestionIndex] === index;
                html += `
                    <label class="option ${isSelected ? 'selected' : ''}" onclick="selectAnswer(${index})">
                        <input type="radio" name="answer" value="${index}" ${isSelected ? 'checked' : ''}>
                        <span class="option-text">${option}</span>
                    </label>
                `;
            });
            
            container.innerHTML = html;
            document.getElementById('validationError').textContent = '';
            updateProgress();
            updateNavigation();
        }

        function selectAnswer(index) {
            userAnswers[currentQuestionIndex] = index;
            displayQuestion();
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            // Validate that an answer is selected
            if (userAnswers[currentQuestionIndex] === null) {
                document.getElementById('validationError').textContent = '‚ö†Ô∏è Please select an answer before proceeding!';
                return;
            }

            if (currentQuestionIndex < currentQuestions.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                submitTest();
            }
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('questionCounter').textContent = `${currentQuestionIndex + 1} / ${currentQuestions.length}`;
        }

        function updateNavigation() {
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            document.getElementById('nextBtn').textContent = currentQuestionIndex === currentQuestions.length - 1 ? 'Submit Test' : 'Next ‚Üí';
        }

        function startTimer() {
            timeLeft = 1800;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitTest();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timer').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function submitTest() {
            clearInterval(timerInterval);
            
            let score = 0;
            currentQuestions.forEach((q, index) => {
                if (userAnswers[index] === q.correct) score++;
            });

            const percentage = ((score / currentQuestions.length) * 100).toFixed(2);
            const result = {
                ...currentStudent,
                score,
                totalQuestions: currentQuestions.length,
                percentage,
                date: new Date().toLocaleString()
            };

            saveResult(result);
            displayResult(result);
        }

        function displayResult(result) {
            document.getElementById('scoreDisplay').textContent = `${result.score}/${result.totalQuestions}`;
            document.getElementById('resultName').textContent = result.name;
            document.getElementById('resultId').textContent = result.id;
            document.getElementById('resultTrade').textContent = result.trade;
            document.getElementById('resultMonth').textContent = `Month ${result.month}`;
            document.getElementById('resultScore').textContent = `${result.score}/${result.totalQuestions}`;
            document.getElementById('resultPercentage').textContent = `${result.percentage}%`;
            showScreen('resultScreen');
        }

        function saveResult(result) {
            const results = JSON.parse(localStorage.getItem('testResults') || '[]');
            results.push(result);
            localStorage.setItem('testResults', JSON.stringify(results));
        }

        function getCompletedTests() {
            return JSON.parse(localStorage.getItem('testResults') || '[]');
        }

        function showAdminLogin() {
            showScreen('adminLoginScreen');
        }

        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === 'admin123') {
                showAdminPanel();
            } else {
                document.getElementById('adminError').textContent = 'Invalid password!';
            }
        }

        function showAdminPanel() {
            const results = getCompletedTests();
            let html = '<table><tr><th>Name</th><th>ID</th><th>Trade</th><th>Month</th><th>Timing</th><th>Score</th><th>%</th><th>Date</th></tr>';
            
            results.forEach(r => {
                html += `<tr>
                    <td>${r.name}</td>
                    <td>${r.id}</td>
                    <td>${r.trade}</td>
                    <td>Month ${r.month}</td>
                    <td>${r.timing}</td>
                    <td>${r.score}/${r.totalQuestions}</td>
                    <td>${r.percentage}%</td>
                    <td>${r.date}</td>
                </tr>`;
            });
            
            html += '</table>';
            document.getElementById('resultsTable').innerHTML = html;
            showScreen('adminPanel');
        }

        function exportCSV() {
            const results = getCompletedTests();
            let csv = 'Name,ID,Trade,Month,Timing,Score,Total Questions,Percentage,Date\n';
            
            results.forEach(r => {
                csv += `${r.name},${r.id},${r.trade},Month ${r.month},${r.timing},${r.score},${r.totalQuestions},${r.percentage}%,${r.date}\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'test_results.csv';
            a.click();
        }

        function clearAllData() {
            if (confirm('Are you sure you want to delete all test results? This cannot be undone!')) {
                localStorage.removeItem('testResults');
                showAdminPanel();
            }
        }

        function backToLogin() {
            showScreen('loginScreen');
            document.getElementById('adminPassword').value = '';
            document.getElementById('adminError').textContent = '';
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }
    </script>
</body>
</html>