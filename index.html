<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MITI - Monthly Test System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); min-height: 100vh; color: #fff; }
        .screen { display: none; }
        .screen.active { display: block; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .login-box, .result-box { background: #2d2d2d; padding: 40px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); width: 100%; max-width: 500px; border: 1px solid #444; }
        h1 { color: #fff; text-align: center; margin-bottom: 30px; font-size: 2.5em; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        h2 { color: #fff; margin-bottom: 20px; text-align: center; }
        input, select { width: 100%; padding: 15px; margin: 10px 0; border: 2px solid #444; border-radius: 8px; font-size: 16px; background: #1a1a1a; color: #fff; }
        input:focus, select:focus { outline: none; border-color: #4CAF50; }
        select option { background: #1a1a1a; color: #fff; }
        button { width: 100%; padding: 15px; margin: 10px 0; background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; transition: transform 0.2s; }
        button:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4); }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        .error { color: #ff6b6b; margin-top: 10px; text-align: center; font-weight: bold; }
        .success { color: #4CAF50; margin-top: 10px; text-align: center; font-weight: bold; }
        .info { color: #2196F3; margin-top: 10px; text-align: center; font-size: 14px; }
        .test-header { background: #2d2d2d; padding: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.5); flex-wrap: wrap; gap: 10px; border-bottom: 2px solid #4CAF50; }
        .timer { font-size: 24px; font-weight: bold; color: #ff6b6b; padding: 10px 20px; background: #1a1a1a; border-radius: 8px; border: 2px solid #ff6b6b; }
        .month-badge { background: #4CAF50; color: white; padding: 8px 15px; border-radius: 20px; font-weight: bold; }
        .trade-badge { background: #2196F3; color: white; padding: 8px 15px; border-radius: 20px; font-size: 12px; }
        .test-container { max-width: 900px; margin: 30px auto; background: #2d2d2d; padding: 30px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); border: 1px solid #444; }
        .progress-bar { width: 100%; height: 8px; background: #1a1a1a; border-radius: 10px; margin-bottom: 30px; border: 1px solid #444; }
        .progress { height: 100%; background: linear-gradient(90deg, #4CAF50 0%, #45a049 100%); transition: width 0.3s; border-radius: 10px; }
        .option { padding: 15px 15px 15px 20px; margin: 10px 0; border: 2px solid #444; border-radius: 8px; cursor: pointer; display: block; transition: all 0.3s; background: #1a1a1a; text-align: left; width: 100%; }
        .option:hover { border-color: #4CAF50; background: #2d2d2d; }
        .option.selected { border-color: #4CAF50; background: #4CAF50; color: white; }
        .option input[type="radio"] { margin-right: 12px; vertical-align: middle; }
        .navigation { display: flex; justify-content: space-between; align-items: center; margin-top: 30px; }
        .navigation button { width: auto; padding: 12px 30px; }
        .result-details { margin: 30px 0; padding: 20px; background: #1a1a1a; border-radius: 8px; border: 1px solid #444; }
        .result-details p { margin: 15px 0; font-size: 18px; color: #fff; }
        .result-details span { color: #4CAF50; font-weight: bold; }
        .score-display { font-size: 48px; text-align: center; color: #4CAF50; font-weight: bold; margin: 20px 0; }
        table { width: 100%; background: #2d2d2d; border-collapse: collapse; margin-top: 20px; border-radius: 8px; overflow: hidden; border: 1px solid #444; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #444; color: #fff; }
        th { background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); color: white; font-weight: bold; }
        tr:hover { background: #1a1a1a; }
        .month-select { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        .month-btn { padding: 20px; background: #1a1a1a; border: 2px solid #444; border-radius: 10px; cursor: pointer; text-align: center; font-weight: bold; transition: all 0.3s; color: #fff; position: relative; }
        .month-btn:hover:not(.completed) { border-color: #4CAF50; background: #2d2d2d; }
        .month-btn.selected { border-color: #4CAF50; background: #4CAF50; color: white; }
        .month-btn.completed { border-color: #4CAF50; }
        .month-btn.completed::after { content: '‚úÖ'; position: absolute; top: 10px; right: 10px; font-size: 20px; }
        .footer { position: fixed; bottom: 10px; right: 20px; color: #888; font-size: 14px; font-style: italic; }
        .question h3 { color: #fff; margin-bottom: 20px; text-align: left; }
        .question p { color: #ddd; text-align: left; font-size: 18px; margin-bottom: 20px; }
        #questionCounter { color: #4CAF50; font-weight: bold; }
        .admin-btn { background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%) !important; margin-top: 20px; }
        .time-slot-info { background: #1a1a1a; padding: 15px; border-radius: 8px; margin: 15px 0; border: 2px solid #2196F3; }
        .time-slot-info h4 { color: #2196F3; margin-bottom: 10px; }
        .time-slot-info p { color: #fff; margin: 5px 0; }
        .admin-panel-box { background: #2d2d2d; padding: 30px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); border: 1px solid #444; margin: 20px 0; }
        .btn-group { display: flex; gap: 10px; flex-wrap: wrap; }
        .btn-group button { flex: 1; min-width: 200px; }
        .question-editor { background: #1a1a1a; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #444; }
        .question-item { background: #2d2d2d; padding: 15px; margin: 10px 0; border-radius: 8px; border: 1px solid #444; }
        .question-item input, .question-item textarea { margin: 5px 0; }
        textarea { width: 100%; padding: 10px; background: #1a1a1a; color: #fff; border: 2px solid #444; border-radius: 8px; font-family: inherit; resize: vertical; min-height: 60px; }
    </style>
</head>
<body>
    <!-- LOGIN SCREEN -->
    <div id="loginScreen" class="screen active">
        <div class="container">
            <h1>üìö MITI Test System</h1>
            <div class="login-box">
                <h2>Student Login</h2>
                <input type="text" id="studentName" placeholder="Enter Your Name">
                <input type="text" id="studentId" placeholder="Enter Your ID Number">
                
                <select id="tradeSelect">
                    <option value="">-- Select Your Trade --</option>
                    <option value="Computerized Accounting">Computerized Accounting</option>
                    <option value="Data Analytics with AI">Data Analytics with AI</option>
                </select>

                <select id="timingSelect" style="display:none;">
                    <option value="">-- Select Timing --</option>
                </select>
                
                <h3 style="margin-top: 20px; color: #fff; font-size: 16px;">Select Test Month:</h3>
                <div class="month-select" id="monthSelect"></div>
                
                <button onclick="startTest()">Start Test</button>
                <button onclick="showAdminLogin()" class="admin-btn">Admin Panel</button>
                <div id="loginError" class="error"></div>
                <div id="loginInfo" class="info"></div>
            </div>
        </div>
    </div>

    <!-- TEST SCREEN -->
    <div id="testScreen" class="screen">
        <div class="test-header">
            <span class="trade-badge" id="tradeBadge"></span>
            <span class="month-badge" id="monthBadge"></span>
            <div class="timer" id="timer">30:00</div>
        </div>
        <div class="test-container">
            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
            </div>
            <div id="questionContainer" class="question"></div>
            <div class="navigation">
                <button onclick="previousQuestion()" id="prevBtn">‚Üê Previous</button>
                <span id="questionCounter"></span>
                <button onclick="nextQuestion()" id="nextBtn">Next ‚Üí</button>
            </div>
        </div>
    </div>

    <!-- RESULT SCREEN -->
    <div id="resultScreen" class="screen">
        <div class="container">
            <div class="result-box">
                <h2>üéâ Test Completed!</h2>
                <div class="score-display" id="scoreDisplay"></div>
                <div class="result-details">
                    <p>Name: <span id="resultName"></span></p>
                    <p>ID: <span id="resultId"></span></p>
                    <p>Trade: <span id="resultTrade"></span></p>
                    <p>Month: <span id="resultMonth"></span></p>
                    <p>Score: <span id="resultScore"></span></p>
                    <p>Percentage: <span id="resultPercentage"></span></p>
                </div>
                <button onclick="location.reload()">Back to Home</button>
            </div>
        </div>
    </div>

    <!-- ADMIN LOGIN -->
    <div id="adminLoginScreen" class="screen">
        <div class="container">
            <h1>üîê Admin Login</h1>
            <div class="login-box">
                <input type="password" id="adminPassword" placeholder="Enter Admin Password">
                <button onclick="adminLogin()">Login</button>
                <button onclick="backToLogin()">Back</button>
                <div id="adminError" class="error"></div>
            </div>
        </div>
    </div>

    <!-- ADMIN PANEL -->
    <div id="adminPanel" class="screen">
        <div class="container" style="max-width: 1200px;">
            <h1>üìä Admin Panel</h1>
            <div class="admin-panel-box">
                <h2>Test Results</h2>
                <div class="btn-group">
                    <button onclick="exportCSV()">üì• Export CSV</button>
                    <button onclick="clearAllData()" style="background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);">üóëÔ∏è Clear All Data</button>
                    <button onclick="backToLogin()">üè† Back to Home</button>
                </div>
                <div id="resultsTable"></div>
            </div>
        </div>
    </div>

    <div class="footer">Developed by Sir Muhammad Faris</div>

    <script>
        // Question Bank
        const questionBank = {
            "Computerized Accounting": {
                1: [
                    {q: "Capital + Liabilities = ?", options: ["Revenue", "Assets", "Expense", "Voucher"], correct: 1},
                    {q: "Owner's claim on total assets is?", options: ["Liability", "Assets", "Equity", "Cash"], correct: 2},
                    {q: "Which of the following financial report show the profitable of a business?", options: ["Income Statement", "Balance Sheet", "Cash Flow Statement", "Statement of changes in equity"], correct: 0},
                    {q: "A Cheque returned by bank marked 'NFS' means that?", options: ["Bank can't verify your identity", "There are Not sufficient Balance", "Cheque has been forged", "Cheque can't be cash being illegal"], correct: 1},
                    {q: "Which of the following is fiscal year of Government of Pakistan?", options: ["1st January to 31st December", "1st June to 31st May", "1st July to 30th June", "1st October to 30th September"], correct: 2},
                    {q: "How many companies open at the same time in QuickBooks?", options: ["One", "Two", "Both of above", "None of above"], correct: 0},
                    {q: "Sales Tax charged on?", options: ["Vendor", "Customer", "Employee", "None of above"], correct: 1},
                    {q: "Which person sales Tax Paid?", options: ["Vendor", "Customer", "Employee", "None of above"], correct: 0},
                    {q: "U/M Stands for?", options: ["Unit Markup", "Unit of Measure"], correct: 1},
                    {q: "How Sale returned transaction recorded in Peachtree?", options: ["Purchase Order‚Üí Enter Bill‚ÜíPay Bill", "Purchase Order‚ÜíEnter Bill", "Sale Order‚Üícreate Invoice‚ÜíCredit & Return‚ÜíReceived payment", "All of Above"], correct: 2}
                ],
                2: [
                    {q: "What is MS EXCEL?", options: ["Spread sheets package", "Graphical software", "All of Above", "None of these"], correct: 0},
                    {q: "What does The VLOOKUP function?", options: ["Lookup text that contains 'V'", "Check weather test is the same in one cell as in the text", "Find related values", "All of Above"], correct: 2},
                    {q: "Which function calculates missing loan amount?", options: ["PV (Present Value)", "FV (Future Value)", "PMT (Payment)", "NPER (Number of periods)"], correct: 2},
                    {q: "How many types of cursors in MS excel?", options: ["FIVE", "THREE", "FOUR"], correct: 1},
                    {q: "Select the right purpose of 'COUNT'", options: ["Count Alphabets", "Count Numeric", "Count Alpha Numeric"], correct: 1},
                    {q: "Which area shows the address of a cell?", options: ["Name Box", "Formula Bar", "Status Bar"], correct: 0},
                    {q: "Circle the correct short key of edit cell.", options: ["F2", "F3", "F9", "F8"], correct: 0},
                    {q: "To select another particular cell in work sheet", options: ["Ctrl + Click", "Ctrl + shift+ Click", "Ctrl + F7"], correct: 0},
                    {q: "What is the meaning of this error #### in a cell?", options: ["Cell width is narrow", "Cell width is long", "None of these"], correct: 0},
                    {q: "What is the File Extension of Excel?", options: [".xlsx", ".Xlx", ".xlsm"], correct: 0}
                ],
                3: [
                    {q: "What is the correct syntax of IF() function?", options: ["=IF(logical test, value_if_true, value_if_false)", "=IF (logical test, TRUE([value_if_true]), FALSE([value_if_false]))", "None of these"], correct: 0},
                    {q: "Which of the following formula enter is not correctly?", options: ["=B7*C7", "-1- + 50", "10+50", "=10+B7"], correct: 1},
                    {q: "Select the right purpose of count.", options: ["Count specific value in our given rang", "Sum specific value in our given rang", "None of These"], correct: 0},
                    {q: "How many conditions can we apply in conditional formatting on one range?", options: ["5", "10", "Unlimited", "3"], correct: 2},
                    {q: "What is the purpose of $ sign in formula?", options: ["For currency Symbol", "For Fix Error", "For Fixing cell Address", "All of these"], correct: 2},
                    {q: "Except for the ...... function, a formula with a logical function shows the word 'TRUE' or 'FALSE' as a result", options: ["End", "OR", "Not", "IF"], correct: 3},
                    {q: "Which function is used to trap and handle errors?", options: ["IFERROR", "ERROR", "IFNA", "None of these"], correct: 0},
                    {q: "What is shortcut key of sum?", options: ["Alt+ Enter", "Alt + =", "Ctrl + +", "Ctrl + ="], correct: 1},
                    {q: "If we select 5 rows and 5 columns how many cells will be selected", options: ["25", "10", "15", "None of these"], correct: 0},
                    {q: "Which symbol must be with all formulas?", options: ["=", "@", "%", "!"], correct: 0}
                ],
                4: [
                    {q: "Circle the correct short key of debug formula and edit cell.", options: ["F2", "F3", "F9", "F8"], correct: 0},
                    {q: "What is the meaning of this error #### in a cell?", options: ["Cell width is narrow", "Cell width is long", "None of these"], correct: 0},
                    {q: "How can we insert a new row in a cell with keyboard?", options: ["Ctrl + Enter", "Ctrl + Alt + Enter", "Alt + Enter"], correct: 2},
                    {q: "Which function in Excel tells how many numeric entries are there?", options: ["NUM", "COUNT", "SUM", "CHKNUM"], correct: 1},
                    {q: "Circle the correct M-Language for insert a file or workbook name in power query.", options: ["Exce.CurrentWorkbook([Content],true)", "Excel.CurrentWorkbook([Content])", "Very Basic Applications", "Visual Basic Applied"], correct: 1},
                    {q: "Why we use Charts and Graphs?", options: ["Graphical Representation", "Numerical Representation", "Immediate window", "Code window"], correct: 0},
                    {q: "Why are purchase order used?", options: ["To post accounting information", "To place an order with a customer", "To request items from vendor"], correct: 2},
                    {q: "Which window do you use to add a new vendor?", options: ["Purchase / Receive Inventory", "Menu Bar", "Maintain vendors"], correct: 2},
                    {q: "Going from the ledger to the original entry window is called?", options: ["Lookup", "Drill down", "None of above"], correct: 1},
                    {q: "Which of the following navigation bar vendor & purchase selection do you use to issue a return of merchandise to a vendor?", options: ["Credit memos", "Sales/invoicing", "Credit & Returns"], correct: 2},
                    {q: "Which of the following choices is not used to modify the chart of accounts?", options: ["Deleting accounts with balances", "Adding new accounts", "Editing accounts", "Deleting unused accounts"], correct: 0},
                    {q: "Which of the following is NOT an Item Type?", options: ["Inventory Part", "Service", "Non-inventory Part", "Income"], correct: 3},
                    {q: "What transaction should you enter if a customer returns a damaged product or, in the case of a service, complains so much you decide to offer a refund?", options: ["Debit Memo", "Credit Memo", "Customer Return", "Check or Bill"], correct: 1},
                    {q: "Which of these functions can only be performed by the Administrator?", options: ["Merge entries on lists", "Add new users and change their access privileges", "Memorize custom reports", "Back up the data file"], correct: 1},
                    {q: "Tally package is developed by", options: ["Saga50", "Tally solution", "Intuit"], correct: 1},
                    {q: "In general, the financial year from shall be from", options: ["1st July of any year", "31st march of any year", "All Answer is correct"], correct: 2},
                    {q: "Which menu appears after starting tally for the first-time?", options: ["Gateway of tally", "Company info", "Display"], correct: 0},
                    {q: "Which option is used in tally to make changes in the company?", options: ["Select company", "Shut company", "Alter"], correct: 2},
                    {q: "Which option is used to copy company's data into pen-drive or CD?", options: ["Backup", "Restore", "Copy data"], correct: 0},
                    {q: "NOTE: Question 1 was a fill-in-the-blank table for Debit/Credit rules (not included in MCQ format)", options: ["Acknowledged"], correct: 0}
                ]
            },
            "Data Analytics with AI": {
                1: [
                    {q: "What is the shortcut key to open a new workbook in Excel?", options: ["Ctrl+N", "Ctrl+O", "Ctrl+W", "Ctrl+S"], correct: 0},
                    {q: "Which function is used to find the average of numbers in Excel?", options: ["SUM", "AVERAGE", "COUNT", "MAX"], correct: 1},
                    {q: "What does VLOOKUP stand for?", options: ["Vertical Lookup", "Value Lookup", "Variable Lookup", "Vector Lookup"], correct: 0},
                    {q: "Which chart type is best for showing trends over time?", options: ["Pie Chart", "Bar Chart", "Line Chart", "Scatter Plot"], correct: 2},
                    {q: "What is the default file extension for Excel 2016 and later?", options: [".xls", ".xlsx", ".csv", ".xlsm"], correct: 1},
                    {q: "Which key combination is used to insert a new row in Excel?", options: ["Ctrl+Shift++", "Alt+I+R", "Ctrl+R", "Shift+R"], correct: 0},
                    {q: "What does the $ symbol do in an Excel formula?", options: ["Adds currency format", "Creates absolute reference", "Multiplies values", "None of the above"], correct: 1},
                    {q: "Which function counts the number of cells containing numbers?", options: ["COUNT", "COUNTA", "COUNTIF", "SUM"], correct: 0},
                    {q: "What is a Pivot Table used for?", options: ["Creating charts", "Summarizing data", "Formatting cells", "Printing data"], correct: 1},
                    {q: "Which Excel feature allows you to apply the same formatting to multiple cells?", options: ["Format Painter", "Cell Styles", "Conditional Formatting", "Themes"], correct: 0}
                ],
                2: [
                    {q: "What does SQL stand for?", options: ["Structured Query Language", "Simple Query Language", "Standard Query Language", "Sequential Query Language"], correct: 0},
                    {q: "Which SQL command is used to retrieve data from a database?", options: ["GET", "SELECT", "FETCH", "RETRIEVE"], correct: 1},
                    {q: "What is a primary key in a database?", options: ["A unique identifier for a record", "The first column in a table", "A foreign key reference", "An index"], correct: 0},
                    {q: "Which clause is used to filter records in SQL?", options: ["FILTER", "WHERE", "HAVING", "SELECT"], correct: 1},
                    {q: "What does the JOIN operation do in SQL?", options: ["Combines rows from two or more tables", "Adds new columns", "Deletes records", "Updates data"], correct: 0},
                    {q: "Which SQL function returns the number of rows?", options: ["SUM()", "COUNT()", "AVG()", "MAX()"], correct: 1},
                    {q: "What is the purpose of the GROUP BY clause?", options: ["To sort data", "To group rows with same values", "To filter data", "To join tables"], correct: 1},
                    {q: "Which data type is used for storing text in MySQL?", options: ["INT", "VARCHAR", "DATE", "FLOAT"], correct: 1},
                    {q: "What does DISTINCT keyword do in SQL?", options: ["Removes duplicate rows", "Sorts data", "Filters data", "Joins tables"], correct: 0},
                    {q: "Which SQL command is used to modify existing data?", options: ["MODIFY", "CHANGE", "UPDATE", "ALTER"], correct: 2}
                ],
                3: [
                    {q: "What is Python primarily used for?", options: ["Web Development", "Data Analysis", "Machine Learning", "All of the above"], correct: 3},
                    {q: "Which library is commonly used for data manipulation in Python?", options: ["NumPy", "Pandas", "Matplotlib", "Scikit-learn"], correct: 1},
                    {q: "What does the 'print()' function do in Python?", options: ["Saves data", "Displays output", "Reads input", "Deletes data"], correct: 1},
                    {q: "Which data structure in Python is ordered and changeable?", options: ["Tuple", "Set", "List", "Dictionary"], correct: 2},
                    {q: "What is the correct way to create a function in Python?", options: ["function myFunc():", "def myFunc():", "create myFunc():", "func myFunc():"], correct: 1},
                    {q: "Which operator is used for exponentiation in Python?", options: ["^", "**", "exp", "pow"], correct: 1},
                    {q: "What does 'len()' function return?", options: ["Length of an object", "Type of object", "Value of object", "None of the above"], correct: 0},
                    {q: "Which library is used for creating visualizations in Python?", options: ["Pandas", "NumPy", "Matplotlib", "Requests"], correct: 2},
                    {q: "What is a DataFrame in Pandas?", options: ["A 2D labeled data structure", "A 1D array", "A dictionary", "A list"], correct: 0},
                    {q: "Which method is used to read a CSV file in Pandas?", options: ["read_csv()", "load_csv()", "import_csv()", "get_csv()"], correct: 0}
                ],
                4: [
                    {q: "What is Power BI primarily used for?", options: ["Data Visualization", "Database Management", "Web Development", "Machine Learning"], correct: 0},
                    {q: "Which Excel function finds the maximum value?", options: ["MAX()", "MAXIMUM()", "HIGHEST()", "TOP()"], correct: 0},
                    {q: "In SQL, which command creates a new table?", options: ["NEW TABLE", "CREATE TABLE", "MAKE TABLE", "ADD TABLE"], correct: 1},
                    {q: "What does API stand for?", options: ["Application Programming Interface", "Advanced Programming Interface", "Automated Programming Interface", "Application Process Interface"], correct: 0},
                    {q: "Which Python library is used for machine learning?", options: ["Pandas", "NumPy", "Scikit-learn", "Matplotlib"], correct: 2},
                    {q: "What is the purpose of data cleaning?", options: ["To remove errors and inconsistencies", "To visualize data", "To store data", "To encrypt data"], correct: 0},
                    {q: "Which chart type shows the relationship between two variables?", options: ["Pie Chart", "Bar Chart", "Scatter Plot", "Line Chart"], correct: 2},
                    {q: "What does ETL stand for in data processing?", options: ["Extract, Transform, Load", "Execute, Test, Launch", "Evaluate, Track, Log", "Export, Transfer, Link"], correct: 0},
                    {q: "Which SQL clause is used to sort results?", options: ["SORT BY", "ORDER BY", "ARRANGE BY", "GROUP BY"], correct: 1},
                    {q: "What is a dashboard in Power BI?", options: ["A single-page visualization", "A database", "A query", "A report"], correct: 0},
                    {q: "Which function in Excel removes leading/trailing spaces?", options: ["CLEAN()", "TRIM()", "STRIP()", "REMOVE()"], correct: 1},
                    {q: "What is normalization in databases?", options: ["Organizing data to reduce redundancy", "Backing up data", "Encrypting data", "Sorting data"], correct: 0},
                    {q: "Which Python data type is immutable?", options: ["List", "Dictionary", "Tuple", "Set"], correct: 2},
                    {q: "What does CSV stand for?", options: ["Comma Separated Values", "Character Separated Values", "Column Separated Values", "Cell Separated Values"], correct: 0},
                    {q: "Which Power BI component connects to data sources?", options: ["Power Query", "Power Pivot", "Power View", "Power Map"], correct: 0},
                    {q: "What is the purpose of indexing in databases?", options: ["To speed up data retrieval", "To backup data", "To encrypt data", "To delete data"], correct: 0},
                    {q: "Which Excel feature allows 'what-if' analysis?", options: ["Goal Seek", "Solver", "Scenario Manager", "All of the above"], correct: 3},
                    {q: "What is a foreign key in SQL?", options: ["A key from another table", "The primary key", "An index", "A unique constraint"], correct: 0},
                    {q: "Which Python keyword is used for conditional statements?", options: ["if", "when", "check", "condition"], correct: 0},
                    {q: "What is data mining?", options: ["Discovering patterns in large datasets", "Storing data", "Deleting data", "Encrypting data"], correct: 0}
                ]
            }
        };

        // Time slots configuration
        const timeSlots = {
            "Computerized Accounting": [
                { label: "Morning (9:00 AM - 12:00 PM)", value: "Morning" },
                { label: "Evening (2:00 PM - 5:00 PM)", value: "Evening" }
            ],
            "Data Analytics with AI": [
                { label: "Morning (9:00 AM - 12:00 PM)", value: "Morning" },
                { label: "Evening (2:00 PM - 5:00 PM)", value: "Evening" }
            ]
        };

        let currentStudent = {};
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let timeLeft = 1800; // 30 minutes
        let timerInterval;

        // Initialize
        document.getElementById('tradeSelect').addEventListener('change', function() {
            const trade = this.value;
            const timingSelect = document.getElementById('timingSelect');
            
            if (trade && timeSlots[trade]) {
                timingSelect.style.display = 'block';
                timingSelect.innerHTML = '<option value="">-- Select Timing --</option>';
                timeSlots[trade].forEach(slot => {
                    timingSelect.innerHTML += `<option value="${slot.value}">${slot.label}</option>`;
                });
                updateMonthButtons();
            } else {
                timingSelect.style.display = 'none';
            }
        });

        function updateMonthButtons() {
            const trade = document.getElementById('tradeSelect').value;
            const timing = document.getElementById('timingSelect').value;
            const monthSelect = document.getElementById('monthSelect');
            
            if (!trade || !timing) {
                monthSelect.innerHTML = '<p style="color: #ff6b6b; text-align: center;">Please select trade and timing first</p>';
                return;
            }

            const completedTests = getCompletedTests();
            monthSelect.innerHTML = '';
            
            for (let i = 1; i <= 4; i++) {
                const isCompleted = completedTests.some(test => 
                    test.trade === trade && 
                    test.month === i && 
                    test.timing === timing
                );
                
                const btn = document.createElement('div');
                btn.className = 'month-btn' + (isCompleted ? ' completed' : '');
                btn.innerHTML = `Month ${i}${i === 4 ? ' (FINAL)' : ''}`;
                btn.onclick = () => selectMonth(i);
                monthSelect.appendChild(btn);
            }
        }

        function selectMonth(month) {
            document.querySelectorAll('.month-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            currentStudent.month = month;
        }

        function startTest() {
            const name = document.getElementById('studentName').value.trim();
            const id = document.getElementById('studentId').value.trim();
            const trade = document.getElementById('tradeSelect').value;
            const timing = document.getElementById('timingSelect').value;
            const month = currentStudent.month;

            if (!name || !id || !trade || !timing || !month) {
                document.getElementById('loginError').textContent = 'Please fill all fields and select month!';
                return;
            }

            const completedTests = getCompletedTests();
            const alreadyCompleted = completedTests.some(test => 
                test.studentId === id && 
                test.trade === trade && 
                test.month === month &&
                test.timing === timing
            );

            if (alreadyCompleted) {
                document.getElementById('loginError').textContent = 'You have already completed this test!';
                return;
            }

            currentStudent = { name, id, trade, timing, month };
            currentQuestions = questionBank[trade][month];
            currentQuestionIndex = 0;
            userAnswers = new Array(currentQuestions.length).fill(null);

            document.getElementById('tradeBadge').textContent = trade;
            document.getElementById('monthBadge').textContent = `Month ${month}${month === 4 ? ' - FINAL TEST' : ''}`;
            
            showScreen('testScreen');
            displayQuestion();
            startTimer();
        }

        function displayQuestion() {
            const q = currentQuestions[currentQuestionIndex];
            const container = document.getElementById('questionContainer');
            
            let html = `
                <h3>Question ${currentQuestionIndex + 1} of ${currentQuestions.length}</h3>
                <p>${q.q}</p>
            `;
            
            q.options.forEach((option, index) => {
                const isSelected = userAnswers[currentQuestionIndex] === index;
                html += `
                    <label class="option ${isSelected ? 'selected' : ''}" onclick="selectAnswer(${index})">
                        <input type="radio" name="answer" value="${index}" ${isSelected ? 'checked' : ''}>
                        ${option}
                    </label>
                `;
            });
            
            container.innerHTML = html;
            updateProgress();
            updateNavigation();
        }

        function selectAnswer(index) {
            userAnswers[currentQuestionIndex] = index;
            displayQuestion();
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (currentQuestionIndex < currentQuestions.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                submitTest();
            }
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('questionCounter').textContent = `${currentQuestionIndex + 1} / ${currentQuestions.length}`;
        }

        function updateNavigation() {
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            document.getElementById('nextBtn').textContent = currentQuestionIndex === currentQuestions.length - 1 ? 'Submit Test' : 'Next ‚Üí';
        }

        function startTimer() {
            timeLeft = 1800;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitTest();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timer').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function submitTest() {
            clearInterval(timerInterval);
            
            let score = 0;
            currentQuestions.forEach((q, index) => {
                if (userAnswers[index] === q.correct) score++;
            });

            const percentage = ((score / currentQuestions.length) * 100).toFixed(2);
            const result = {
                ...currentStudent,
                score,
                totalQuestions: currentQuestions.length,
                percentage,
                date: new Date().toLocaleString()
            };

            saveResult(result);
            displayResult(result);
        }

        function displayResult(result) {
            document.getElementById('scoreDisplay').textContent = `${result.score}/${result.totalQuestions}`;
            document.getElementById('resultName').textContent = result.name;
            document.getElementById('resultId').textContent = result.id;
            document.getElementById('resultTrade').textContent = result.trade;
            document.getElementById('resultMonth').textContent = `Month ${result.month}`;
            document.getElementById('resultScore').textContent = `${result.score}/${result.totalQuestions}`;
            document.getElementById('resultPercentage').textContent = `${result.percentage}%`;
            showScreen('resultScreen');
        }

        function saveResult(result) {
            const results = JSON.parse(localStorage.getItem('testResults') || '[]');
            results.push(result);
            localStorage.setItem('testResults', JSON.stringify(results));
        }

        function getCompletedTests() {
            return JSON.parse(localStorage.getItem('testResults') || '[]');
        }

        function showAdminLogin() {
            showScreen('adminLoginScreen');
        }

        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === 'admin123') {
                showAdminPanel();
            } else {
                document.getElementById('adminError').textContent = 'Invalid password!';
            }
        }

        function showAdminPanel() {
            const results = getCompletedTests();
            let html = '<table><tr><th>Name</th><th>ID</th><th>Trade</th><th>Month</th><th>Timing</th><th>Score</th><th>%</th><th>Date</th></tr>';
            
            results.forEach(r => {
                html += `<tr>
                    <td>${r.name}</td>
                    <td>${r.id}</td>
                    <td>${r.trade}</td>
                    <td>Month ${r.month}</td>
                    <td>${r.timing}</td>
                    <td>${r.score}/${r.totalQuestions}</td>
                    <td>${r.percentage}%</td>
                    <td>${r.date}</td>
                </tr>`;
            });
            
            html += '</table>';
            document.getElementById('resultsTable').innerHTML = html;
            showScreen('adminPanel');
        }

        function exportCSV() {
            const results = getCompletedTests();
            let csv = 'Name,ID,Trade,Month,Timing,Score,Total Questions,Percentage,Date\n';
            
            results.forEach(r => {
                csv += `${r.name},${r.id},${r.trade},Month ${r.month},${r.timing},${r.score},${r.totalQuestions},${r.percentage}%,${r.date}\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'test_results.csv';
            a.click();
        }

        function clearAllData() {
            if (confirm('Are you sure you want to delete all test results? This cannot be undone!')) {
                localStorage.removeItem('testResults');
                showAdminPanel();
            }
        }

        function backToLogin() {
            showScreen('loginScreen');
            document.getElementById('adminPassword').value = '';
            document.getElementById('adminError').textContent = '';
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }
    </script>
</body>
</html>